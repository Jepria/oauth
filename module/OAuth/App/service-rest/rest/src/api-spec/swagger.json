{
  "openapi": "3.0.0",
  "info": {
    "version": "1.0.0",
    "title": "OAuth 2.0 Provider API"
  },
  "tags": [
    {
      "name": "OAuth",
      "description": "OAuth authentication management"
    }
  ],
  "servers": [
    {
      "url": "/{appContextPath}/{apiEndpoint}"
    }
  ],
  "paths": {
    "/authorize": {
      "get": {
        "tags": ["OAuth"],
        "summary": "Start authorization",
        "description": "This endpoint is used in the authorization code and implicit OAuth 2.0 flows which require end-user interaction",
        "operationId": "authorize",
        "parameters": [
          {
            "name": "response_type",
            "in": "query",
            "description": "OAuth authorization server expected response type",
            "required": true,
            "schema": {
              "type": "string",
              "enum": [
                "code",
                "token"
              ]
            }
          },
          {
            "name": "client_id",
            "in": "query",
            "description": "Client Application identificator",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "redirect_uri",
            "in": "query",
            "description": "URI (Base64URL without padding) to return the user to after authorization is completed",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "state",
            "in": "query",
            "required": true,
            "description": "A random string generated by client",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "302": {
            "content": {
              "application/x-www-form-urlencoded": {
                "schema": {
                  "type": "string",
                  "example" : "https://client.example/callback?error=access_denied&state=xyz || https://client.example/callback#error=access_denied&state=xyz",
                  "properties": {
                    "code": {
                      "type": "string",
                      "description": "authorization code"
                    },
                    "error": {
                      "type": "string",
                      "description": "A single ASCII [USASCII] error code from the following: \n  * _invalid_request_ - The request is missing a required parameter, includes an invalid parameter value, includes parameter more than once, or is otherwise malformed. \n  * _unauthorized_client_ - The client is not authorized to request an access token using this method. \n * _access_denied_ - The resource owner or authorization server denied the request.\n  * _unsupported_response_type_ - The authorization server does not support obtaining an access token using this method.\n  * _server_error_ - The authorization server encountered an unexpected condition that prevented it from fulfilling the request.",
                      "enum": [
                        "invalid_request",
                        "unauthorized_client",
                        "access_denied",
                        "unsupported_response_type",
                        "server_error"
                      ]
                    },
                    "error_description": {
                      "type": "string",
                      "description": "Human-readable ASCII [USASCII] text providing additional information"
                    },
                    "state": {
                      "type": "string",
                      "description": "CSRF token"
                    }
                  }
                },
                "examples": {
                  "implicit": {
                    "value": "https://client.example/callback?error=access_denied&state=xyz",
                    "summary": "Authorization Code Flow"
                  },
                  "code": {
                    "value": "https://client.example/callback#error=access_denied&state=xyz",
                    "summary": "Implicit Flow"
                  }
                }
              }
            },
            "description": "Redirect to provided request URI"
          }
        }
      }
    },
    "/logout": {
      "get": {
        "tags": ["OAuth"],
        "summary": "Logout from application and cancel OAuth session",
        "operationId": "logout",
        "parameters": [
          {
            "name": "client_id",
            "in": "query",
            "required": true,
            "description": "Client application identificator",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "redirect_uri",
            "in": "query",
            "description": "URI (Base64URL without padding) to return the user to after logout is completed",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "state",
            "in": "query",
            "description": "A random string generated by client",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "SID",
            "in": "cookie",
            "description": "Session identificator cookie",
            "required": false,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "302": {
            "description": "redirect to redirect_uri from query param"
          }
        }
      }
    }
  }
}